<div class="dashboard">
  <header class="header">
    <h1>ğŸ“Š Dashboard Reporte Diverza</h1>
    <p>Carga tu archivo Excel para visualizar las mÃ©tricas</p>
  </header>

  <!-- Upload Section -->
  <div 
    class="upload-section" 
    [class.dragover]="isDragOver"
    [class.has-data]="hasData"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave($event)"
    (drop)="onDrop($event)"
    (click)="fileInput.click()">
    
    <input 
      #fileInput 
      type="file" 
      accept=".xlsx,.xls" 
      (change)="onFileSelect($event)" 
      hidden>
    
    <div class="upload-icon">ğŸ“</div>
    
    @if (isLoading) {
      <p class="upload-text">Procesando archivo...</p>
      <div class="spinner"></div>
    } @else if (hasData) {
      <p class="upload-text">âœ… <strong>{{ fileName }}</strong> cargado correctamente</p>
      <p class="upload-hint">Haz clic para cargar otro archivo</p>
    } @else {
      <p class="upload-text">Arrastra tu archivo Excel aquÃ­ o <strong>haz clic</strong> para seleccionar</p>
      <p class="upload-hint">Se leerÃ¡ la hoja "Reporte Diverza" automÃ¡ticamente</p>
    }
    
    @if (errorMessage) {
      <p class="error-message">{{ errorMessage }}</p>
    }
  </div>

  <!-- KPIs Section -->
  @if (stats) {
    <div class="kpi-container">
      <div class="kpi-card">
        <div class="kpi-value">{{ stats.totalFacturas }}</div>
        <div class="kpi-label">Total Facturas</div>
      </div>
      
      <div class="kpi-card highlight">
        <div class="kpi-value">{{ formatCurrency(stats.totalMonto) }}</div>
        <div class="kpi-label">Monto Total</div>
      </div>
      
      <div class="kpi-card">
        <div class="kpi-value">{{ formatCurrency(stats.totalIVA) }}</div>
        <div class="kpi-label">Total IVA</div>
      </div>
      
      <div class="kpi-card">
        <div class="kpi-value">{{ formatCurrency(stats.promedioFactura) }}</div>
        <div class="kpi-label">Promedio por Factura</div>
      </div>
      
      <div class="kpi-card success">
        <div class="kpi-value">{{ stats.facturasPagadas }}</div>
        <div class="kpi-label">Pagadas</div>
      </div>
      
      <div class="kpi-card warning">
        <div class="kpi-value">{{ stats.facturasPendientes }}</div>
        <div class="kpi-label">Pendientes</div>
      </div>
    </div>

    <!-- Charts Section -->
    <div class="charts-container">
      <div class="chart-card">
        <h3>ğŸ’° Top 5 Clientes por Monto</h3>
        <div class="chart-wrapper">
          <canvas baseChart
            [data]="clienteChartData"
            [type]="barChartType"
            [options]="chartOptions">
          </canvas>
        </div>
      </div>

      <div class="chart-card">
        <h3>ğŸ“Š Estado de Facturas</h3>
        <div class="chart-wrapper">
          <canvas baseChart
            [data]="estadoChartData"
            [type]="pieChartType"
            [options]="pieChartOptions">
          </canvas>
        </div>
      </div>

      <div class="chart-card full-width">
        <h3>ğŸ“… Monto por Mes</h3>
        <div class="chart-wrapper">
          <canvas baseChart
            [data]="mesChartData"
            [type]="barChartType"
            [options]="chartOptions">
          </canvas>
        </div>
      </div>
    </div>

    <!-- Actions -->
    <div class="actions">
      <a routerLink="/listado" class="btn btn-primary">
        ğŸ“‹ Ver Listado Completo
      </a>
    </div>
  }
</div>
